{"version":3,"sources":["webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SheetTab/SheetTab.scss?cd6f","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SheetTab/SheetTab.scss","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcher.scss?5111","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcher.scss","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/AdditionalTabsFlyout.js","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/TabOptionsFlyout.js","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/TabOptionsButton.js","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SheetTab/SheetTab.js","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcher.js","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcherContainer.js","webpack:///./src/ui/src/helpers/spreadsheetSwitchContainerHelpers.js","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/index.js"],"names":["api","content","__esModule","default","module","i","options","styleTag","window","isApryseWebViewerWebComponent","document","head","appendChild","webComponents","getElementsByTagName","length","findNestedWebComponents","tagName","root","elements","querySelectorAll","forEach","el","push","shadowRoot","clonedStyleTags","webComponent","onload","styleNode","innerHTML","cloneNode","exports","locals","AdditionalTabsFlyout","props","_props$id","id","additionalTabs","tabsForReference","onClick","activeItem","dispatch","useDispatch","currentFlyout","useSelector","state","selectors","getFlyout","useLayoutEffect","noteStateFlyout","dataElement","className","items","map","item","tabLabel","name","label","title","option","disabled","isActive","Symbol","toString","sheetIndex","actions","updateFlyout","addFlyout","propTypes","PropTypes","string","arrayOf","shape","number","bool","array","func","TabOptionsFlyout","sheetId","handleClick","sheetCount","flyoutSelector","concat","DataElements","SHEET_TAB_OPTIONS_FLYOUT","handleRenameWithFocus","useFocusHandler","e","handleDeleteWithFocus","TabOptions","_props$handleClick","onToggle","t","_slicedToArray","useTranslation","React","createElement","Fragment","ToggleElementButton","img","toggleElement","SheetOptionsFlyout","sheet","any","isRequired","activeSheetLabel","setLabelBeingEdited","setActiveSheet","renameSheet","deleteSheet","isEditMode","checkIsSheetNameDuplicated","noRightBorder","isReadOnlyMode","skipDeleteWarning","SheetTab","_ref","_useState2","useState","inputValue","setInputValue","_useState4","isInputError","setIsInputError","inputRef","useRef","useEffect","current","focus","inputErrorWarning","warningKey","warning","message","confirmBtnText","onConfirm","onCancel","showWarningMessage","onInputBlur","isInputValueDuplicated","isEmpty","trim","handleInputBlurWithFocusTransfer","useFocusOnClose","component","type","classNames","ref","value","onChange","newLabel","target","isDuplicate","onBlur","onKeyDown","key","aria-invalid","aria-label","Button","role","ariaSelected","ariaLabel","useI18String","replace","toLowerCase","newActiveLabel","tabIndex","sheetName","text","secondaryBtnText","memo","SpreadsheetSwitcher","_tabs$find","_props$tabs","tabs","_props$activeSheetInd","activeSheetIndex","createNewSheet","_props$skipDeleteWarn","find","tab","width","useWindowDimensions","breakpoint","useMemo","Math","floor","labelBeingEdited","getSpreadsheetEditorEditMode","SpreadsheetEditorEditMode","VIEW_ONLY","updateActiveTab","handleTabNameClick","index","preventDefault","stopPropagation","_useMemo2","slice","slicedTabs","flyoutTabs","tabListRef","currentFocusIndex","useTabKeyboardNavigation","tabElements","isActiveSheetInFlyout","some","ADDITIONAL_SPREADSHEET_TABS_MENU","Icon","glyph","ERROR","NEW_SPREADSHEET_NUMBER","SpreadsheetSwitcherContainer","sheets","setSheets","setActiveSheetIndex","onSpreadsheetEditorSheetStateChanged","event","getVisibleSheets","getActiveSheetIndex","onSpreadsheetEditorSheetChanged","getSheetIndex","onSpreadsheetEditorReady","workbookInstance","core","getDocumentViewer","getDocument","getSpreadsheetEditorDocument","getWorkbook","sheetArray","getSheetAt","getSheetsFromWorkbook","addEventListener","removeEventListener","handleDocumentUnloaded","useCallback","useOnDocumentUnloaded","_core$getDocument3","_core$getDocument3$ge","workbook","console","error","getSheet","removeSheet","ownProps","_objectSpread","_core$getDocument","_core$getDocument$get","_core$getDocument2","_core$getDocument2$ge","newName","isNameUnique","createSheet","oldName","_core$getDocument4","_core$getDocument4$ge","_core$getDocument5","_core$getDocument5$ge","currentSheet","newNameLowerCase","isSheetNameDuplicated"],"mappings":"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","file":"chunks/chunk.52.js","sourcesContent":["var api = require(\"!../../../../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../../../../node_modules/css-loader/index.js!../../../../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../../../../node_modules/sass-loader/dist/cjs.js!./SheetTab.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function(styleTag) {\n                function findNestedWebComponents(tagName, root = document) {\n                  const elements = [];\n\n                  // Check direct children\n                  root.querySelectorAll(tagName).forEach((el) => elements.push(el));\n\n                  // Check shadow DOMs\n                  root.querySelectorAll('*').forEach((el) => {\n                    if (el.shadowRoot) {\n                      elements.push(...findNestedWebComponents(tagName, el.shadowRoot));\n                    }\n                  });\n\n                  return elements;\n                }\n                if (!window.isApryseWebViewerWebComponent) {\n                  document.head.appendChild(styleTag);\n                  return;\n                }\n\n                let webComponents;\n                // First we see if the webcomponent is at the document level\n                webComponents = document.getElementsByTagName('apryse-webviewer');\n                // If not, we check have to check if it is nested in another webcomponent\n                if (!webComponents.length) {\n                  webComponents = findNestedWebComponents('apryse-webviewer');\n                }\n                // Now we append the style tag to each webcomponent\n                const clonedStyleTags = [];\n                for (let i = 0; i < webComponents.length; i++) {\n                  const webComponent = webComponents[i];\n                  if (i === 0) {\n                    webComponent.shadowRoot.appendChild(styleTag);\n                    styleTag.onload = function() {\n                      if (clonedStyleTags.length > 0) {\n                        clonedStyleTags.forEach((styleNode) => {\n                          // eslint-disable-next-line no-unsanitized/property\n                          styleNode.innerHTML = styleTag.innerHTML;\n                        });\n                      }\n                    };\n                  } else {\n                    const styleNode = styleTag.cloneNode(true);\n                    webComponent.shadowRoot.appendChild(styleNode);\n                    clonedStyleTags.push(styleNode);\n                  }\n                }\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","exports = module.exports = require(\"../../../../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".sheet-tab{cursor:pointer;border-bottom:none;border-top-right-radius:4px;border-top-left-radius:4px;min-width:170px;height:40px;position:relative;border-inline-end:1px solid transparent}.sheet-tab:hover{background:var(--faded-component-background)}.sheet-tab.no-left-border .tab-body{border-inline-end:1px solid transparent}.sheet-tab .tab-body{height:24px;display:flex;padding:0;padding-inline-start:8px;padding-inline-end:8px;width:100%;position:absolute;inset-block-start:50%;transform:translateY(-50%);border-inline-end:1px solid var(--border)}.sheet-tab .tab-body.input-mode{padding-inline-start:5px;padding-inline-end:6px}.sheet-tab .tab-body .sheet-label{width:calc(100% - 24px);text-align:start;justify-content:left;height:24px}.sheet-tab .tab-body .sheet-label span{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.sheet-tab .tab-body .sheet-input{max-width:100%}.sheet-tab .tab-body input.input-error{border-color:red}.sheet-tab.active{border:1px solid var(--border);border-bottom:none;background:var(--gray-0)}.sheet-tab.active .tab-body{border-inline-end:1px solid transparent}.sheet-tab .sheet-options .ToggleElementButton button{width:24px;height:24px;min-width:24px}.sheet-tab .sheet-options .ToggleElementButton button .Icon{width:16px;height:14px}.sheet-tab .sheet-options .more-options-icon{height:24px;width:24px}.sheet-tab .sheet-options .more-options-icon .Icon{width:16px;height:16px}\", \"\"]);\n\n// exports\n","var api = require(\"!../../../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../../../node_modules/css-loader/index.js!../../../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../../../node_modules/sass-loader/dist/cjs.js!./SpreadsheetSwitcher.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function(styleTag) {\n                function findNestedWebComponents(tagName, root = document) {\n                  const elements = [];\n\n                  // Check direct children\n                  root.querySelectorAll(tagName).forEach((el) => elements.push(el));\n\n                  // Check shadow DOMs\n                  root.querySelectorAll('*').forEach((el) => {\n                    if (el.shadowRoot) {\n                      elements.push(...findNestedWebComponents(tagName, el.shadowRoot));\n                    }\n                  });\n\n                  return elements;\n                }\n                if (!window.isApryseWebViewerWebComponent) {\n                  document.head.appendChild(styleTag);\n                  return;\n                }\n\n                let webComponents;\n                // First we see if the webcomponent is at the document level\n                webComponents = document.getElementsByTagName('apryse-webviewer');\n                // If not, we check have to check if it is nested in another webcomponent\n                if (!webComponents.length) {\n                  webComponents = findNestedWebComponents('apryse-webviewer');\n                }\n                // Now we append the style tag to each webcomponent\n                const clonedStyleTags = [];\n                for (let i = 0; i < webComponents.length; i++) {\n                  const webComponent = webComponents[i];\n                  if (i === 0) {\n                    webComponent.shadowRoot.appendChild(styleTag);\n                    styleTag.onload = function() {\n                      if (clonedStyleTags.length > 0) {\n                        clonedStyleTags.forEach((styleNode) => {\n                          // eslint-disable-next-line no-unsanitized/property\n                          styleNode.innerHTML = styleTag.innerHTML;\n                        });\n                      }\n                    };\n                  } else {\n                    const styleNode = styleTag.cloneNode(true);\n                    webComponent.shadowRoot.appendChild(styleNode);\n                    clonedStyleTags.push(styleNode);\n                  }\n                }\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","exports = module.exports = require(\"../../../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".Flyout[\\\\:has\\\\(.SheetOptionsFlyout\\\\)]{z-index:130}.Flyout:has(.SheetOptionsFlyout){z-index:130}.SpreadsheetSwitcher{padding:0}.GenericFileTab{display:flex;padding-inline-start:4px;padding-top:4px}.GenericFileTab .dropdown-menu{border:1px solid var(--border);margin-top:3px;margin-inline-start:5px}.GenericFileTab .dropdown-menu .Icon{position:absolute}.GenericFileTab .add-sheet-tab{margin-top:3px;margin-inline-start:5px}.GenericFileTab .add-sheet-tab .Icon{width:14px;height:14px}\", \"\"]);\n\n// exports\n","import { useLayoutEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport selectors from 'selectors';\nimport actions from 'actions';\nimport PropTypes from 'prop-types';\n\nconst AdditionalTabsFlyout = (props) => {\n  const {\n    id = '',\n    additionalTabs,\n    tabsForReference,\n    onClick,\n    activeItem,\n  } = props;\n  const dispatch = useDispatch();\n\n  const currentFlyout = useSelector((state) => selectors.getFlyout(state, id));\n\n  useLayoutEffect(() => {\n    const noteStateFlyout = {\n      dataElement: id,\n      className: 'AdditionalTabsFlyout',\n      items: additionalTabs.map((item) => {\n        const tabLabel = item.name;\n\n        return {\n          label: tabLabel,\n          title: tabLabel,\n          option: tabLabel,\n          disabled: item.disabled,\n          isActive: tabLabel === activeItem,\n          dataElement: Symbol(tabLabel).toString(),\n          onClick: () => onClick(tabLabel, item.sheetIndex),\n        };\n      })\n    };\n    if (!currentFlyout) {\n      dispatch(actions.addFlyout(noteStateFlyout));\n    } else {\n      dispatch(actions.updateFlyout(noteStateFlyout.dataElement, noteStateFlyout));\n    }\n  }, [tabsForReference, activeItem]);\n\n  return null;\n};\n\nAdditionalTabsFlyout.propTypes = {\n  id: PropTypes.string,\n  additionalTabs: PropTypes.arrayOf(PropTypes.shape({\n    name: PropTypes.string,\n    sheetIndex: PropTypes.number,\n    disabled: PropTypes.bool,\n  })),\n  tabsForReference: PropTypes.array,\n  onClick: PropTypes.func,\n  activeItem: PropTypes.string,\n};\n\nexport default AdditionalTabsFlyout;\n\n\n","import { useLayoutEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport DataElements from 'src/constants/dataElement';\nimport actions from 'actions';\nimport selectors from 'selectors';\nimport useFocusHandler from 'hooks/useFocusHandler';\n\nconst TabOptionsFlyout = (props) => {\n  const {\n    sheetId,\n    handleClick,\n    sheetCount,\n    disabled,\n  } = props;\n\n  const dispatch = useDispatch();\n  const flyoutSelector = `${DataElements.SHEET_TAB_OPTIONS_FLYOUT}-${sheetId}`;\n  const currentFlyout = useSelector((state) => selectors.getFlyout(state, flyoutSelector));\n\n  const handleRenameWithFocus = useFocusHandler((e) => handleClick('Rename', e));\n  const handleDeleteWithFocus = useFocusHandler((e) => handleClick('Delete', e));\n\n  useLayoutEffect(() => {\n    const noteStateFlyout = {\n      dataElement: flyoutSelector,\n      className: 'TabOptionsFlyout',\n      items: [\n        {\n          label: 'action.rename',\n          title: 'action.rename',\n          option: 'Rename',\n          dataElement: 'sheetTabRenameOption',\n          onClick: handleRenameWithFocus,\n        },\n        {\n          label: 'action.delete',\n          title: 'action.delete',\n          option: 'Delete',\n          dataElement: 'sheetTabDeleteOption',\n          onClick: handleDeleteWithFocus,\n          disabled: (sheetCount === 1 || disabled),\n        }\n      ]\n    };\n\n    if (!currentFlyout) {\n      dispatch(actions.addFlyout(noteStateFlyout));\n    } else {\n      dispatch(actions.updateFlyout(noteStateFlyout.dataElement, noteStateFlyout));\n    }\n  }, [sheetCount, disabled, handleClick]);\n\n  return null;\n};\n\nTabOptionsFlyout.propTypes  = {\n  sheetId: PropTypes.string,\n  handleClick: PropTypes.func,\n  sheetCount: PropTypes.number,\n  disabled: PropTypes.bool,\n};\n\nexport default TabOptionsFlyout;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport ToggleElementButton from 'components/ModularComponents/ToggleElementButton';\nimport { useTranslation } from 'react-i18next';\nimport SheetOptionsFlyout from './TabOptionsFlyout';\nimport DataElements from 'src/constants/dataElement';\n\n\nconst TabOptions = (props) => {\n  const {\n    handleClick = () => { },\n    id,\n    onToggle,\n    label,\n    disabled,\n    sheetCount,\n  } = props;\n\n  const [t] = useTranslation();\n  const icon = 'icon-tools-more-vertical';\n\n  return (\n    <>\n      <ToggleElementButton\n        dataElement={`options-${id}`}\n        title={`${t('option.searchPanel.moreOptions')} ${label}`}\n        img={icon}\n        onToggle={(isActive) => {\n          if (isActive) {\n            onToggle(label);\n          }\n        }}\n        disabled={disabled}\n        toggleElement={`${DataElements.SHEET_TAB_OPTIONS_FLYOUT}-${id}`}\n      />\n      <SheetOptionsFlyout\n        sheetId={id}\n        sheetCount={sheetCount}\n        handleClick={(option) => handleClick(id, label, option)}\n        disabled={disabled}\n      />\n    </>\n  );\n};\n\nTabOptions.propTypes = {\n  id: PropTypes.string,\n  label: PropTypes.string,\n  onToggle: PropTypes.func,\n  handleClick: PropTypes.func,\n  disabled: PropTypes.bool,\n  sheetCount: PropTypes.number,\n};\n\nexport default TabOptions;\n","import React, { useEffect, useState, useRef } from 'react';\nimport { useDispatch } from 'react-redux';\nimport actions from 'actions';\nimport PropTypes from 'prop-types';\nimport Button from 'components/Button';\nimport classNames from 'classnames';\nimport TabOptions from '../TabOptionsButton';\nimport { useTranslation } from 'react-i18next';\nimport './SheetTab.scss';\nimport useFocusOnClose from 'hooks/useFocusOnClose';\n\nconst propTypes = {\n  sheet: PropTypes.any.isRequired,\n  sheetCount: PropTypes.number,\n  activeSheetLabel: PropTypes.string.isRequired,\n  setLabelBeingEdited: PropTypes.func.isRequired,\n  setActiveSheet: PropTypes.func.isRequired,\n  renameSheet: PropTypes.func.isRequired,\n  deleteSheet: PropTypes.func.isRequired,\n  onClick: PropTypes.func.isRequired,\n  isEditMode: PropTypes.bool.isRequired,\n  checkIsSheetNameDuplicated: PropTypes.func,\n  noRightBorder: PropTypes.bool,\n  isReadOnlyMode: PropTypes.bool,\n  skipDeleteWarning: PropTypes.bool,\n};\n\nconst SheetTab = ({\n  sheet,\n  activeSheetLabel,\n  onClick,\n  sheetCount,\n  setLabelBeingEdited,\n  setActiveSheet,\n  isEditMode,\n  noRightBorder,\n  checkIsSheetNameDuplicated,\n  isReadOnlyMode,\n  deleteSheet,\n  renameSheet,\n  skipDeleteWarning,\n}) => {\n  const { sheetIndex, name: label, disabled } = sheet;\n\n  const isActive = label === activeSheetLabel;\n\n  const [inputValue, setInputValue] = useState('');\n  const [isInputError, setIsInputError] = useState(false);\n  const { t } = useTranslation();\n  const inputRef = useRef();\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (inputValue && inputRef.current) {\n      inputRef.current.focus();\n    }\n  }, [inputValue]);\n\n  const onInputChange = (e) => {\n    const newLabel = e.target.value;\n    const isDuplicate = checkIsSheetNameDuplicated(newLabel);\n    setIsInputError(isDuplicate);\n    setInputValue(newLabel);\n  };\n\n  const updateActiveTab = (newActiveLabel, tabIndex) => {\n    setLabelBeingEdited(null);\n    setIsInputError(false);\n    setActiveSheet(newActiveLabel, tabIndex);\n  };\n\n  const startLabelEditingMode = (text) => {\n    setInputValue(text);\n    setIsInputError(false);\n    setLabelBeingEdited(text);\n  };\n\n  const inputErrorWarning = () => {\n    const isEmpty = inputValue === '';\n    const warningKey = isEmpty ? 'warning.sheetTabRenameIssueTwo' : 'warning.sheetTabRenameIssueOne';\n    const warning = {\n      message: t(`${warningKey}.message`),\n      title: t(`${warningKey}.title`),\n      confirmBtnText: t('action.ok'),\n      onConfirm: () => inputRef.current.focus(),\n      onCancel: () => {\n        setLabelBeingEdited(false);\n        setIsInputError(false);\n        setInputValue(label);\n      }\n    };\n    dispatch(actions.showWarningMessage(warning));\n  };\n\n  const onInputBlur = () => {\n    if (isInputError) {\n      inputErrorWarning();\n      return;\n    }\n    const isInputValueDuplicated = checkIsSheetNameDuplicated(inputValue);\n    const isEmpty = inputValue.trim() === '';\n\n    if (isInputValueDuplicated || isEmpty) {\n      setIsInputError(true);\n      inputErrorWarning();\n      return;\n    }\n\n    renameSheet(label, inputValue);\n    setLabelBeingEdited(null);\n    setIsInputError(false);\n    setInputValue('');\n  };\n\n  const handleInputBlurWithFocusTransfer = useFocusOnClose(onInputBlur, 'addTabButton');\n\n  const onKeyDown = (e) => {\n    if (e.key === 'Enter' && !isInputError) {\n      handleInputBlurWithFocusTransfer();\n    }\n  };\n\n  const handleTabOptionSelection = (id, sheetName, option) => {\n    if (option === 'Rename') {\n      startLabelEditingMode(sheetName);\n    } else if (option === 'Delete') {\n      if (skipDeleteWarning) {\n        return deleteSheet(label);\n      }\n      const message = t('warning.sheetTabDeleteMessage.message');\n      const title = t('warning.sheetTabDeleteMessage.title');\n      const confirmBtnText = t('action.ok');\n      const secondaryBtnText = t('action.cancel');\n      const warning = {\n        message,\n        title,\n        confirmBtnText,\n        secondaryBtnText,\n        onConfirm: () => {\n          deleteSheet(label);\n        },\n      };\n      dispatch(actions.showWarningMessage(warning));\n    }\n  };\n\n  let component = null;\n  if (isEditMode) {\n    component = (\n      <input type='text'\n        className={classNames('sheet-input', { 'input-error': isInputError })}\n        ref={inputRef}\n        value={inputValue}\n        onChange={onInputChange}\n        onBlur={onInputBlur}\n        onKeyDown={onKeyDown}\n        aria-invalid={isInputError}\n        aria-label={t('action.rename')}\n      />\n    );\n  } else {\n    component = (\n      <>\n        <Button\n          role='tab'\n          // ariaControls={'document-container'}\n          ariaSelected={isActive}\n          ariaLabel={label}\n          className={'sheet-label'}\n          onClick={(e) => onClick(e, label, sheetIndex)}\n          title={label}\n          label={label}\n          useI18String={false}\n          disabled={disabled}\n        />\n        <div className='sheet-options'>\n          <TabOptions id={label?.replace(/\\s+/g, '-').toLowerCase()}\n            label={label}\n            sheetCount={sheetCount}\n            onToggle={(name) => updateActiveTab(name, sheetIndex)}\n            handleClick={handleTabOptionSelection}\n            disabled={isReadOnlyMode}\n          />\n        </div>\n      </>\n    );\n  }\n\n  return (<div className={classNames({\n    'active': isActive,\n    'no-left-border': noRightBorder,\n    'disabled': disabled,\n  }, 'sheet-tab')}\n  >\n    <div className={classNames({ 'input-mode': isEditMode },'tab-body')}>\n      {component}\n    </div>\n  </div>);\n\n};\n\nSheetTab.propTypes = propTypes;\n\nexport default React.memo(SheetTab);","import React, { useState, useMemo, useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport { useTranslation } from 'react-i18next';\nimport useWindowDimensions from 'helpers/useWindowsDimensions';\nimport Button from 'components/Button';\nimport ToggleElementButton from 'components/ModularComponents/ToggleElementButton';\nimport Icon from 'components/Icon';\nimport DataElements from 'constants/dataElement';\nimport { SpreadsheetEditorEditMode } from 'constants/spreadsheetEditor';\nimport AdditionalTabsFlyout from './AdditionalTabsFlyout';\nimport SheetTab from './SheetTab/SheetTab';\nimport './SpreadsheetSwitcher.scss';\nimport PropTypes from 'prop-types';\nimport selectors from 'selectors';\nimport useTabKeyboardNavigation from 'hooks/useArrowNavigation';\n\nconst SpreadsheetSwitcher = (props) => {\n  const {\n    tabs = [],\n    activeSheetIndex = 0,\n    setActiveSheet,\n    createNewSheet,\n    deleteSheet,\n    renameSheet,\n    checkIsSheetNameDuplicated,\n    skipDeleteWarning = false,\n  } = props;\n  const activeSheetLabel = tabs.find((tab) => tab.sheetIndex === activeSheetIndex)?.name || '';\n  const { width } = useWindowDimensions();\n  const breakpoint = useMemo(() => Math.floor((width - 80) / 170), [width]);\n  const { t } = useTranslation();\n  const [labelBeingEdited, setLabelBeingEdited] = useState('');\n\n  const spreadsheetEditorEditMode = useSelector(selectors.getSpreadsheetEditorEditMode);\n  const isReadOnlyMode = spreadsheetEditorEditMode === SpreadsheetEditorEditMode.VIEW_ONLY;\n\n  const updateActiveTab = (newActiveLabel, tabIndex) => {\n    setLabelBeingEdited(null);\n    setActiveSheet(newActiveLabel, tabIndex);\n  };\n\n  const handleTabNameClick = (e, label, index) => {\n    e.preventDefault();\n    e.stopPropagation();\n    updateActiveTab(label, index);\n  };\n\n  // Break the sheet tabs into two, one regular view, and one into flyout\n  const [slicedTabs, flyoutTabs] = useMemo(() => {\n    return [tabs.slice(0, breakpoint), tabs.slice(breakpoint)];\n  }, [tabs, breakpoint]);\n\n  const tabListRef = useRef();\n  const {\n    currentFocusIndex,\n  } = useTabKeyboardNavigation(tabListRef, [slicedTabs, labelBeingEdited]);\n\n  const tabElements = slicedTabs.map((item, i) => (\n    <SheetTab\n      key={item.sheetIndex}\n      sheet={item}\n      sheetCount={tabs.length}\n      activeSheetLabel={activeSheetLabel}\n      onClick={handleTabNameClick}\n      isEditMode={labelBeingEdited === item.name}\n      setLabelBeingEdited={setLabelBeingEdited}\n      setActiveSheet={setActiveSheet}\n      deleteSheet={deleteSheet}\n      renameSheet={renameSheet}\n      noRightBorder={tabs[item.sheetIndex + 1] && tabs[item.sheetIndex + 1].name === activeSheetLabel}\n      checkIsSheetNameDuplicated={checkIsSheetNameDuplicated}\n      isReadOnlyMode={isReadOnlyMode}\n      skipDeleteWarning={skipDeleteWarning}\n      tabIndex={currentFocusIndex === i ? 0 : -1}\n    />\n  ));\n\n  const isActiveSheetInFlyout = useMemo(() => {\n    return flyoutTabs.some((item) => item.name === activeSheetLabel);\n  }, [flyoutTabs, activeSheetLabel]);\n\n  return (\n    <div className=\"SpreadsheetSwitcher ModularHeader BottomHeader stroke start\">\n      <div className={'GenericFileTab'} role='tablist' ref={tabListRef}>\n        {tabElements}\n        {\n          (flyoutTabs?.length > 0) ?\n            (\n              <ToggleElementButton\n                className=\"dropdown-menu tab-dropdown-button\"\n                dataElement=\"tabTrigger\"\n                title={t('message.showMore')}\n                toggleElement={DataElements.ADDITIONAL_SPREADSHEET_TABS_MENU}\n                label={flyoutTabs.length.toString()}\n              >\n                {(isActiveSheetInFlyout) && (<Icon glyph=\"icon-active-indicator\"></Icon>)}\n              </ToggleElementButton>\n            ) : null\n        }\n        <Button\n          className=\"add-sheet-tab\"\n          title=\"action.addSheet\"\n          img=\"icon-menu-add\"\n          onClick={createNewSheet}\n          dataElement={'addTabButton'}\n          label={''}\n          ariaLabel={t('action.addSheet')}\n          disabled={isReadOnlyMode}\n        />\n        {flyoutTabs?.length > 0 &&\n          (\n            <AdditionalTabsFlyout\n              id={DataElements.ADDITIONAL_SPREADSHEET_TABS_MENU}\n              additionalTabs={flyoutTabs}\n              tabsForReference={tabs}\n              onClick={updateActiveTab}\n              activeItem={activeSheetLabel}\n            />\n          )\n        }\n      </div>\n    </div>\n  );\n};\n\nSpreadsheetSwitcher.propTypes = {\n  tabs: PropTypes.arrayOf(PropTypes.shape({\n    name: PropTypes.string,\n    sheetIndex: PropTypes.number,\n    disabled: PropTypes.bool,\n  })),\n  activeSheetIndex: PropTypes.number,\n  setActiveSheet: PropTypes.func,\n  createNewSheet: PropTypes.func,\n  deleteSheet: PropTypes.func,\n  renameSheet: PropTypes.func,\n  skipDeleteWarning: PropTypes.bool,\n  checkIsSheetNameDuplicated: PropTypes.func,\n};\n\nexport default SpreadsheetSwitcher;","import React, { useState, useEffect, useCallback } from 'react';\nimport core from 'core';\nimport SpreadsheetSwitcher from './SpreadsheetSwitcher';\nimport useOnDocumentUnloaded from 'hooks/useOnDocumentUnloaded';\nimport { useTranslation } from 'react-i18next';\nimport useFocusOnClose from 'src/hooks/useFocusOnClose';\nimport { isSheetNameDuplicated } from 'helpers/spreadsheetSwitchContainerHelpers';\n\nconst ERROR = 'SpreadsheetEditorDocument is not loaded';\nlet NEW_SPREADSHEET_NUMBER = 2;\n\nfunction SpreadsheetSwitcherContainer(props) {\n  const { t } = useTranslation();\n  const [sheets, setSheets] = useState([]);\n  const [activeSheetIndex, setActiveSheetIndex] = useState(0);\n\n  const getSheetsFromWorkbook = (workbookInstance) => {\n    let sheetCount = workbookInstance.sheetCount;\n    const sheetArray = [];\n    for (let i = 0; i < sheetCount; i++) {\n      const sheet = workbookInstance.getSheetAt(i);\n      sheetArray.push({ name: sheet.name, sheetIndex: i });\n    }\n    return sheetArray;\n  };\n\n  useEffect(() => {\n    const onSpreadsheetEditorSheetStateChanged = (event) => {\n      setSheets(event.getVisibleSheets());\n      setActiveSheetIndex(event.getActiveSheetIndex());\n    };\n\n    const onSpreadsheetEditorSheetChanged = (event) => {\n      setActiveSheetIndex(event.getSheetIndex());\n    };\n\n    const onSpreadsheetEditorReady = () => {\n      const documentViewer = core.getDocumentViewer();\n      const doc = documentViewer.getDocument().getSpreadsheetEditorDocument();\n      const workbookInstance = doc.getWorkbook();\n      if (workbookInstance) {\n        setSheets(getSheetsFromWorkbook(workbookInstance));\n      }\n    };\n\n    core.addEventListener('activeSheetChanged', onSpreadsheetEditorSheetChanged);\n    core.addEventListener('spreadsheetEditorReady', onSpreadsheetEditorReady);\n    core.addEventListener('sheetChanged', onSpreadsheetEditorSheetStateChanged);\n    return () => {\n      core.removeEventListener('sheetChanged', onSpreadsheetEditorSheetStateChanged);\n      core.removeEventListener('spreadsheetEditorReady', onSpreadsheetEditorReady);\n      core.removeEventListener('activeSheetChanged', onSpreadsheetEditorSheetChanged);\n    };\n  }, []);\n\n  const handleDocumentUnloaded = useCallback(() => {\n    setSheets([]);\n    setActiveSheetIndex(0);\n  }, []);\n  useOnDocumentUnloaded(handleDocumentUnloaded);\n\n  const setActiveSheet = (name, index) => {\n    const workbook = core.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();\n    if (!workbook) {\n      return console.error(ERROR);\n    }\n\n    if (workbook.getSheetAt(index)) {\n      workbook.setActiveSheet(index);\n      setActiveSheetIndex(index);\n    }\n  };\n\n  const createNewSheet = () => {\n    const workbook = core.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();\n    if (!workbook) {\n      return console.error(ERROR);\n    }\n\n    let newName = t('spreadsheetEditor.blankSheet');\n    let isNameUnique = !workbook.getSheet(newName);\n    while (!isNameUnique) {\n      newName = `${t('spreadsheetEditor.blankSheet')} ${NEW_SPREADSHEET_NUMBER++}`;\n      isNameUnique = !workbook.getSheet(newName);\n    }\n    workbook.createSheet(newName);\n  };\n\n  const deleteSheet = useFocusOnClose((name) => {\n    const workbook = core.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();\n    if (!workbook) {\n      return console.error(ERROR);\n    }\n\n    if (workbook.getSheet(name)) {\n      workbook.removeSheet(name);\n    }\n  }, 'addTabButton');\n\n  const renameSheet = (oldName, newName) => {\n    const workbook = core.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();\n    if (!workbook) {\n      return console.error(ERROR);\n    }\n\n    const sheet = workbook.getSheet(oldName);\n    if (sheet) {\n      sheet.name = newName;\n    }\n  };\n\n  const checkIsSheetNameDuplicated = (newName) => {\n    const workbook = core.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();\n    if (!workbook) {\n      console.error(ERROR);\n      return false;\n    }\n\n    return isSheetNameDuplicated(\n      sheets,\n      sheets[activeSheetIndex],\n      newName\n    );\n  };\n\n  const ownProps = {\n    ...props,\n    tabs: sheets,\n    activeSheetIndex,\n    setActiveSheet,\n    createNewSheet,\n    deleteSheet,\n    renameSheet,\n    checkIsSheetNameDuplicated\n  };\n\n  return (<SpreadsheetSwitcher {...ownProps} />);\n}\n\nSpreadsheetSwitcherContainer.propTypes = { };\n\nexport default SpreadsheetSwitcherContainer;","export const isSheetNameDuplicated = (sheets, currentSheet, newName) => {\n  const newNameLowerCase = newName.toLowerCase();\n  return sheets.some((sheet) =>\n    sheet.name.toLowerCase() === newNameLowerCase &&\n    sheet.sheetIndex !== currentSheet.sheetIndex\n  );\n};","import SpreadsheetSwitcherContainer from './SpreadsheetSwitcherContainer';\n\nexport default SpreadsheetSwitcherContainer;"],"sourceRoot":""}